{% extends "base.html" %}
{% block title %}Order {{ order.id }}{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto py-8">
  <div class="bg-white p-6 rounded shadow">
    <div class="flex justify-between items-start">
      <div>
        <h2 class="text-2xl font-bold mb-1">Order #{{ order.id }}</h2>
        <div class="text-sm text-gray-600">Placed: {{ order.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
        <div class="mt-2 text-sm">Status: <span class="font-semibold">{{ order.status }}</span></div>
      </div>
      <div class="text-right">
        <div class="text-lg font-bold">R{{ '%.2f'|format(order.total or 0) }}</div>
        <a class="mt-2 inline-block bg-blue-600 text-white px-4 py-2 rounded" href="{{ url_for('order_receipt', order_id=order.id) }}">Download Receipt</a>
        {% if order.status == 'Pending Payment' %}
          <a class="mt-2 inline-block bg-green-600 text-white px-4 py-2 rounded ml-2" href="{{ url_for('order_pay', order_id=order.id) }}">Pay Now</a>
        {% endif %}
      </div>
    </div>

    <hr class="my-4">

    <h3 class="font-semibold mb-2">Items</h3>
    <div class="space-y-3">
      {% for it in items %}
        <div class="p-3 border rounded">
          <div class="flex justify-between">
            <div>
              <div class="font-medium">Milkshake {{ it.index if it.index is defined else loop.index }}</div>
              <div class="text-sm text-gray-600">Flavour: {{ it.flavour }}, Consistency: {{ it.thick }}, Topping: {{ it.topping }}</div>
            </div>
            <div class="text-right font-semibold">R{{ '%.2f'|format(it.price or 0) }}</div>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="mt-4 text-sm text-gray-700">
      <div>Subtotal: R{{ '%.2f'|format(order.subtotal or 0) }}</div>
      <div>Discount: R{{ '%.2f'|format(order.discount or 0) }}</div>
      <div>VAT (15%): R{{ '%.2f'|format(order.vat or 0) }}</div>
      <div class="mt-2 font-bold">Total: R{{ '%.2f'|format(order.total or 0) }}</div>
    </div>

    <div class="mt-4 text-sm">
      <div>Pickup time: {{ order.pickup_time.strftime('%Y-%m-%d %H:%M') if order.pickup_time else 'N/A' }}</div>
      <div>Pickup location: {{ order.location or 'N/A' }}</div>
    </div>
  </div>
</div>
{% endblock %}